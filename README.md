# é¡¹ç›®åç§°-ScoreMaster

## ä¸€ã€é¡¹ç›®åç§°-ScoreMasterï¼šä¸€æ¬¾åŸºäº Web çš„æˆç»©ç®¡ç†ç³»ç»Ÿ

![home](https://github.com/pahhcn/ScoreMaster/blob/main/src/assets/42.jpg/home.png)

### ä¸€ã€è¦æ±‚

> å®Œæˆæˆç»©ç®¡ç†ç³»ç»Ÿwebuiè®¾è®¡ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š

1. èƒ½æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥è¯¢æˆç»©ä¿¡æ¯ï¼›
2. èƒ½æŒ‰æŸç§‘æˆç»©ã€æ€»åˆ†ã€å¹³å‡åˆ†è¿›è¡Œæ’åºæ˜¾ç¤ºï¼›
3. èƒ½å¿«é€ŸæŒ‘é€‰æŸ¥è¯¢å‡ºç‰¹å®šåŒå­¦ï¼Œå¦‚å§“åï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼Œå¦‚ç‹XXï¼‰ã€ä»»æ„ç§‘ç›®ç‰¹å®šæˆç»©æŸ¥è¯¢ç­‰ã€‚

> `ä½œä¸šå¼€å‘ç¯å¢ƒè¯´æ˜ï¼š`

1. vscode ï¼ˆä½¿ç”¨ VS Code è¿œç¨‹è¿æ¥ VMware è™šæ‹Ÿæœºï¼Œä½œä¸ºä¸»è¦å¼€å‘ï¼‰
2. ubuntu22.04  (å®éªŒè¿è¡Œç³»ç»Ÿç¯å¢ƒ)
3. windows11
4. WindTermï¼ˆç”¨äºè¿œç¨‹ç™»å½• Ubuntu ç³»ç»Ÿå’Œæ–‡ä»¶ä¼ è¾“ï¼‰
5. GitHub Copilotï¼ˆAI ç¼–ç¨‹åŠ©æ‰‹ï¼Œè¾…åŠ©ä»£ç è‡ªåŠ¨è¡¥å…¨ä¸é—®é¢˜è§£å†³ï¼‰



## äºŒã€ç³»ç»Ÿæ¶æ„ä¸æŠ€æœ¯æ ˆ

### 2.1 æŠ€æœ¯æ¶æ„

- å‰ç«¯æ¡†æ¶ï¼šVue 3
- ç»„ä»¶åº“ï¼šElement Plusã€Arco Design
- æ„å»ºå·¥å…·ï¼šVite
- åç«¯æ¡†æ¶ï¼šNode.js + Express
- æ•°æ®åº“ï¼šMySQL
- é€šä¿¡åè®®ï¼šRESTful API
- éƒ¨ç½²æ–¹å¼ï¼šæœ¬åœ°è¿è¡Œ / æœåŠ¡å™¨éƒ¨ç½²

### 2.2 ç³»ç»ŸåŠŸèƒ½æ¨¡å—ï¼ˆå‰ç«¯é¡µé¢ï¼‰

- é¦–é¡µï¼šæ¬¢è¿é¡µé¢ï¼Œå±•ç¤ºç³»ç»Ÿç®€ä»‹
- æˆç»©æŸ¥è¯¢ï¼šæ”¯æŒå¤šæ¡ä»¶æŸ¥è¯¢ä¸ç»“æœå±•ç¤º
- æˆç»©æ’åºï¼šæ”¯æŒæŒ‰å­—æ®µæ’åºæˆç»©
- æ·»åŠ æˆç»©ï¼šå½•å…¥æ–°å­¦ç”Ÿæˆç»©ä¿¡æ¯
- ä¿®æ”¹æˆç»©ï¼šç¼–è¾‘å·²æœ‰å­¦ç”Ÿæˆç»©æ•°æ®
- åˆ é™¤æˆç»©ï¼šåˆ é™¤æŒ‡å®šå­¦ç”Ÿæˆç»©è®°å½•
- å…³äºé¡µé¢ï¼šç®€å•ä»‹ç»è€Œå·²



## ä¸‰ã€åŠŸèƒ½æ¨¡å—è®¾è®¡

### 4.1 æˆç»©ç®¡ç†æ¨¡å—

- æ·»åŠ æˆç»©ï¼šæ”¯æŒå½•å…¥å­¦ç”Ÿæˆç»©ã€‚

- ä¿®æ”¹æˆç»©ï¼šæ”¯æŒå¯¹å·²æœ‰æˆç»©è¿›è¡Œç¼–è¾‘ã€‚

- åˆ é™¤æˆç»©ï¼šæ”¯æŒåˆ é™¤æŒ‡å®šå­¦ç”Ÿçš„æˆç»©ã€‚

- æŸ¥è¯¢æˆç»©ï¼šæ”¯æŒæŒ‰å­¦å·ã€å§“åã€ç§‘ç›®ã€åˆ†æ•°èŒƒå›´ç­‰æ¡ä»¶æŸ¥è¯¢ã€‚

### 4.2 æˆç»©æ’åºæ¨¡å—

- æ”¯æŒæŒ‰æ€»åˆ†ã€å¹³å‡åˆ†æˆ–ä»»æ„ç§‘ç›®æ’åºã€‚

- æä¾›å‡åºå’Œé™åºé€‰é¡¹ã€‚


### 4.3 æ¡ä»¶ç­›é€‰æ¨¡å—

- æ”¯æŒå§“åæ¨¡ç³ŠæŸ¥è¯¢ï¼ˆå¦‚â€œç‹XXâ€ï¼‰ã€‚
- æ”¯æŒæŒ‰åˆ†æ•°èŒƒå›´ç­›é€‰ç‰¹å®šç§‘ç›®æˆç»©ã€‚

## å››ã€å…³é”®å®ç°é€»è¾‘(API)

###  4.1 å­—æ®µæ˜ å°„ï¼ˆè‹±æ–‡å­—æ®µè½¬ä¸­æ–‡å­—æ®µï¼‰

ç»Ÿä¸€å­—æ®µå¤„ç†ï¼Œé€‚ç”¨äºæŸ¥è¯¢ã€æ·»åŠ ã€æ›´æ–°ã€‚

```js
function mapRow(row) {
  const newRow = {}
  for (const key in row) {
    newRow[keyMap[key] || key] = row[key]
  }
  return newRow
}
```

------

###  4.2 æˆç»©æŸ¥è¯¢ï¼ˆæ”¯æŒæ¨¡ç³Šã€ç­›é€‰ã€æ’åºï¼‰

- æ”¯æŒæŒ‰ `name` æ¨¡ç³Šæœç´¢
- æ”¯æŒæŒ‰ä»»æ„è¯¾ç¨‹ `subject` è¿‡æ»¤ï¼ˆ`min`ã€`max`ï¼‰
- æ”¯æŒ `sort + order` æ’åº
- è‡ªåŠ¨è®¡ç®— `total` ä¸ `avg`

```js
router.get('/scores', (req, res) => {
  const { name, sort, order = 'desc', subject, min, max } = req.query
  let sql = 'SELECT * FROM scores WHERE 1=1'
  const params = []

  if (name) {
    sql += ' AND å§“å LIKE ?'
    params.push(`%${name}%`)
  }

  if (subject) {
    const subjectCN = Object.keys(keyMap).find(k => keyMap[k] === subject)
    if (subjectCN && min) {
      sql += ` AND \`${subjectCN}\` >= ?`
      params.push(Number(min))
    }
    if (subjectCN && max) {
      sql += ` AND \`${subjectCN}\` <= ?`
      params.push(Number(max))
    }
  }

  db.query(sql, params, (err, results) => {
    if (err) return res.status(500).send([])

    const mappedResults = results.map(row => {
      const newRow = mapRow(row)
      let total = 0, count = 0
      for (const key in newRow) {
        if (!['xh', 'name'].includes(key)) {
          const score = convertGradeToScore(newRow[key])
          if (!isNaN(score)) {
            total += score
            count++
          }
        }
      }
      newRow.total = total
      newRow.avg = count ? parseFloat((total / count).toFixed(2)) : 0
      return newRow
    })

    // æ’åºå¤„ç†
    let finalResults = mappedResults
    if (sort) {
      finalResults = [...mappedResults].sort((a, b) => {
        const aVal = a[sort], bVal = b[sort]
        if (aVal == null) return 1
        if (bVal == null) return -1
        return order === 'asc' ? aVal - bVal : bVal - aVal
      })
    }

    res.send(finalResults)
  })
})
```

------

###  4.3 æŸ¥è¯¢å•ä¸ªå­¦ç”Ÿæˆç»©ï¼ˆæŒ‰å­¦å·ï¼‰

æŒ‰å­¦å· `xh` æŸ¥è¯¢å•ä¸ªå­¦ç”Ÿï¼Œå­—æ®µæ˜ å°„å¹¶è®¡ç®— `total` ä¸ `avg`ã€‚

```js
router.get('/scores/:xh', (req, res) => {
  const xh = req.params.xh
  db.query('SELECT * FROM scores WHERE å­¦å· = ?', [xh], (err, results) => {
    if (err) return res.status(500).send([])
    if (!results.length) return res.send([])

    const row = mapRow(results[0])
    let total = 0, count = 0
    for (const key in row) {
      if (!['xh', 'name'].includes(key)) {
        const score = convertGradeToScore(row[key])
        if (!isNaN(score)) {
          total += score
          count++
        }
      }
    }
    row.total = total
    row.avg = count ? (total / count).toFixed(2) : 0
    res.send([row])
  })
})
```

------

###  4.4 æ·»åŠ æˆç»©

```js
router.post('/scores', (req, res) => {
  const data = {}
  for (const k in req.body) {
    const cnKey = Object.keys(keyMap).find(key => keyMap[key] === k) || k
    data[cnKey] = req.body[k]
  }
  const fields = Object.keys(data).map(f => `\`${f}\``).join(',')
  const values = Object.values(data)
  const placeholders = values.map(() => '?').join(',')

  db.query(`INSERT INTO scores (${fields}) VALUES (${placeholders})`, values, (err, result) => {
    if (err) return res.status(500).send({ success: false })
    res.send({ success: true, id: result.insertId })
  })
})
```

------

###  4.5 ä¿®æ”¹ & åˆ é™¤æˆç»©

ä¿®æ”¹æˆç»©ï¼ˆPUTï¼‰ï¼šæŒ‰å­¦å·æ›´æ–°è®°å½•ï¼Œå­—æ®µä¹Ÿæ”¯æŒè‹±æ–‡è½¬ä¸­æ–‡ã€‚

```js
router.put('/scores/:xh', (req, res) => {
  const xh = req.params.xh
  const data = {}
  for (const k in req.body) {
    const cnKey = Object.keys(keyMap).find(key => keyMap[key] === k) || k
    data[cnKey] = req.body[k]
  }
  const fields = Object.keys(data).map(f => `\`${f}\`=?`).join(',')
  const values = [...Object.values(data), xh]
  db.query(`UPDATE scores SET ${fields} WHERE å­¦å·=?`, values, (err) => {
    if (err) return res.status(500).send({ success: false })
    res.send({ success: true })
  })
})
```

åˆ é™¤æˆç»©ï¼ˆDELETEï¼‰ï¼š

```js
router.delete('/scores/:xh', (req, res) => {
  db.query('DELETE FROM scores WHERE å­¦å·=?', [req.params.xh], (err) => {
    if (err) return res.status(500).send({ success: false })
    res.send({ success: true })
  })
})
```

------

###  4.6ï¼šæ–‡å­—æˆç»©è½¬æ•°å€¼å‡½æ•°

```js
function convertGradeToScore(val) {
  if (typeof val === 'number') return val
  const gradeMap = { 'ä¼˜ç§€': 90, 'è‰¯å¥½': 80, 'ä¸­ç­‰': 70, 'åŠæ ¼': 60, 'ä¸åŠæ ¼': 50 }
  return gradeMap[val] ?? NaN
}
```



## äº”ã€é¡¹ç›®æ‰˜ç®¡

### 5.1é¡¹ç›®æºä»£ç 

é¡¹ç›®æºä»£ç å·²æ‰˜ç®¡è‡³ GitHubï¼šğŸ‘‰ https://github.com/pahhcn/ScoreMaster

> åŒ…å«å‰ç«¯ï¼ˆVite + Vue3ï¼‰ã€åç«¯ï¼ˆExpress + MySQLï¼‰ã€æ•°æ®åº“æ–‡ä»¶ç­‰æ‰€æœ‰æºç ã€‚

### 5.2é¡¹ç›®éƒ¨ç½²



` é¡¹ç›®ç»“æ„è¯´æ˜ï¼š`

```
bashå¤åˆ¶ç¼–è¾‘ScoreMaster/
â”œâ”€â”€ client/         # å‰ç«¯ä»£ç ï¼ˆVite + Vue3ï¼‰
â”œâ”€â”€ server/         # åç«¯æ¥å£ï¼ˆExpressï¼‰
â”œâ”€â”€ db/             # æ•°æ®åº“è„šæœ¬åŠç¤ºä¾‹æ•°æ®
â”œâ”€â”€ server.js       # å¯åŠ¨åç«¯å…¥å£
â”œâ”€â”€ package.json    # é¡¹ç›®ä¾èµ–
```

`ç¯å¢ƒä¾èµ–ï¼š`

- Node.js â‰¥ 16
- MySQL â‰¥ 5.7
- æ¨èä½¿ç”¨ `pnpm` / `npm` ä½œä¸ºåŒ…ç®¡ç†å™¨

### 5.3æœ¬åœ°éƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/pahhcn/ScoreMaster.git
cd ScoreMaster

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æ•°æ®åº“ï¼ˆMySQLï¼‰å¹¶å¯¼å…¥è¡¨ç»“æ„ä¸æ•°æ®scores è¡¨
sudo systemctl start mysql

# å¯åŠ¨åç«¯æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ 3000ï¼‰
node server.js

# å¯åŠ¨å‰ç«¯é¡¹ç›®ï¼ˆVite dev serverï¼Œé»˜è®¤ç«¯å£ 5173ï¼‰
npm run dev
```